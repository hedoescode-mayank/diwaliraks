<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Diwali Rakshita!</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* New: Pulsing yellow glow effect */
        body::before {
            content: '';
            position: fixed; /* Use fixed to cover viewport */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.15) 0%, rgba(255, 215, 0, 0) 70%);
            animation: pulse-glow 5s ease-in-out infinite;
            z-index: 0;
        }

        @keyframes pulse-glow {
            0%, 100% {
                opacity: 0.7;
                transform: scale(1.1);
            }
            50% {
                opacity: 1;
                transform: scale(1.3);
            }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            position: relative; /* Updated */
            z-index: 2; /* Updated: Content on top of glow */
        }
        
        /* Entrance Section */
        #entrance {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            text-align: center;
            padding: 20px;
        }
        
        .title {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            margin-bottom: 30px;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.5rem;
            margin-bottom: 50px;
            color: #ffa500;
        }
        
        .door-button {
            background: linear-gradient(135deg, #ff8c00 0%, #ff4500 100%);
            border: none;
            border-radius: 50px;
            padding: 15px 40px;
            font-size: 1.5rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.7);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .door-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 140, 0, 0.9);
        }
        
        .door-button:after {
            content: "";
            position: absolute;
            top: -50%;
            left: -60%;
            width: 20%;
            height: 200%;
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(30deg);
            transition: all 0.5s;
        }
        
        .door-button:hover:after {
            left: 120%;
        }
        
        /* Path Map Section */
        #path-map {
            display: none;
            width: 100%;
            padding: 40px 20px;
            position: relative;
        }
        
        .path-container {
            position: relative;
            width: 100%;
            height: 200px;
            margin-bottom: 50px;
        }
        
        .path-line {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, #ff8c00, #ff4500);
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(255, 140, 0, 0.7);
        }
        
        .path-nodes {
            display: flex;
            justify-content: space-between;
            position: relative;
            width: 100%;
            margin-top: 40px;
        }
        
        .node {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff8c00 0%, #ff4500 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(255, 140, 0, 0.7);
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }
        
        .node:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(255, 140, 0, 0.9);
        }
        
        .node.active {
            background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.9);
        }
        
        .node-label {
            position: absolute;
            bottom: -30px;
            font-size: 0.9rem;
            text-align: center;
            width: 100px;
            left: -10px;
        }
        
        .footsteps {
            position: absolute;
            width: 30px;
            height: 40px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ffd700"><path d="M10.59 5.41L14.18 9H3v2h11.18l-3.59 3.59L12 16l6-6-6-6-1.41 1.41z"/></svg>') no-repeat center;
            background-size: contain;
            opacity: 0;
        }
        
        /* Tareef Section */
        #tareef-section {
            display: none;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(255, 140, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .tareef-title {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 30px;
            color: #ffd700;
        }
        
        .tareef-line {
            font-size: 1.3rem;
            margin-bottom: 20px;
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            color: #fff;
            line-height: 1.6;
        }
        
        .tareef-line.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Updated: Warm pulse animation for highlights */
        .highlight {
            color: #ffd700;
            font-weight: bold;
            animation: pulse-warm 1.5s ease-in-out infinite;
        }

        @keyframes pulse-warm {
            0%, 100% {
                text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
            }
            50% {
                text-shadow: 0 0 20px rgba(255, 215, 0, 1);
            }
        }
        
        /* Spin Wheel Section */
        #spin-wheel-section {
            display: none;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            padding: 30px;
            text-align: center;
        }
        
        .wheel-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto 30px;
        }
        
        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                #ff4500 0deg 72deg,
                #ff8c00 72deg 144deg,
                #ffd700 144deg 216deg,
                #ffa500 216deg 288deg,
                #ff6347 288deg 360deg
            );
            position: relative;
            transition: transform 3s cubic-bezier(0.17, 0.67, 0.83, 0.67);
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.7);
        }
        
        .wheel-section {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .wheel-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: #fff;
            border-radius: 50%;
            z-index: 2;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .spin-button {
            background: linear-gradient(135deg, #ff8c00 0%, #ff4500 100%);
            border: none;
            border-radius: 50px;
            padding: 15px 40px;
            font-size: 1.2rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.7);
            transition: all 0.3s ease;
        }
        
        .spin-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 140, 0, 0.9);
        }
        
        .result {
            margin-top: 20px;
            font-size: 1.5rem;
            min-height: 40px;
            color: #ffd700;
        }
        
        /* Interactive Boxes Section */
        #interactive-boxes-section {
            display: none;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            text-align: center;
        }
        
        .boxes-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .box {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #ff8c00 0%, #ff4500 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(255, 140, 0, 0.7);
            transition: all 0.3s ease;
        }
        
        .box:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(255, 140, 0, 0.9);
        }
        
        /* Final Message Section */
        #final-message {
            display: none;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 50px 30px;
            text-align: center;
        }
        
        .diwali-greeting {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            color: #ffd700;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .message {
            font-size: 1.5rem;
            margin-bottom: 40px;
            color: #ffa500;
        }
        
        /* Music Control */
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }
        
        .music-button {
            background: rgba(255, 140, 0, 0.8);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 140, 0, 0.7);
            transition: all 0.3s ease;
        }
        
        .music-button:hover {
            background: rgba(255, 140, 0, 1);
            transform: scale(1.1);
        }
        
        /* New: Realistic Fireworks */
        .firework-particle {
            position: fixed; /* Use fixed to overlay everything */
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--color);
            box-shadow: 0 0 5px #fff, 0 0 10px var(--color), 0 0 15px var(--color);
            animation: particle-explode 1.2s ease-out forwards;
            z-index: 101; /* On top of everything */
        }

        @keyframes particle-explode {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            50% {
                opacity: 1;
            }
            100% {
                /* Apply horizontal translation and final vertical translation (with gravity) */
                transform: translate(var(--tx), var(--ty_final)) scale(0);
                opacity: 0;
            }
        }
        
        /* Updated: Emoji Diya */
        .floating-diya {
            position: fixed; /* Use fixed so diyas overlay viewport reliably */
            font-size: 30px; /* Use font-size for emoji */
            text-shadow: 0 0 10px #ffd700, 0 0 15px #ffa500; /* Glow effect */
            animation: float 6s ease-in-out infinite;
            z-index: 1; /* Above background glow, below content */
            pointer-events: none; /* Prevent diyas intercepting clicks */
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-20px) rotate(10deg);
            }
        }
        
        .confetti {
            position: fixed; /* Use fixed to overlay */
            width: 10px;
            height: 10px;
            background: #ff0;
            animation: confetti-fall 5s linear forwards;
            z-index: 101; /* On top of everything */
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.2rem;
            }
            
            .door-button {
                font-size: 1.2rem;
                padding: 12px 30px;
            }
            
            .node {
                width: 60px;
                height: 60px;
                font-size: 0.8rem;
            }
            
            .tareef-line {
                font-size: 1.1rem;
            }
            
            .wheel-container {
                width: 250px;
                height: 250px;
            }
            
            .diwali-greeting {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <section id="entrance">
            <h1 class="title">Happy Diwali Rakshita!</h1>
            <p class="subtitle">A special Diwali experience just for you</p>
            <button class="door-button" id="darwaza-khol">Darwaza Khol</button>
        </section>
        
        <section id="path-map">
            <div class="path-container">
                <div class="path-line"></div>
                <div class="path-nodes">
                    <div class="node" id="node1">
                        1
                        <div class="node-label">Tareef</div>
                    </div>
                    <div class="node" id="node2">
                        2
                        <div class="node-label">Spin Wheel</div>
                    </div>
                    <div class="node" id="node3">
                        3
                        <div class="node-label">Boxes</div>
                    </div>
                    <div class="node" id="node4">
                        4
                        <div class="node-label">Final</div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="tareef-section">
            <h2 class="tareef-title">A Few Words for You...</h2>
            <div id="tareef-lines">
                </div>
        </section>
        
        <section id="spin-wheel-section">
            <h2>Diwali Spin Wheel</h2>
            <div class="wheel-container">
                <div class="wheel" id="wheel">
                    <div class="wheel-center"></div>
                </div>
            </div>
            <button class="spin-button" id="spin-button">Spin the Wheel</button>
            <div class="result" id="spin-result"></div>
        </section>
        
        <section id="interactive-boxes-section">
            <h2>Interactive Diwali Boxes</h2>
            <div class="boxes-container">
                <div class="box" data-text="fuljhari">fuljhari</div>
                <div class="box" data-text="badki fuljhari">badki fuljhari</div>
                <div class="box" data-text="skyshot">skyshot</div>
            </div>
            <p>Click on any box to see the magic!</p>
        </section>
        
        <section id="final-message">
            <h1 class="diwali-greeting">Happy Diwali Rakshita!</h1>
            <p class="message">May your life be filled with joy, prosperity, and love</p>
        </section>
    </div>
    
    <div class="music-control">
        <button class="music-button" id="music-toggle">â™ª</button>
    </div>
    
    <audio id="background-music" loop preload="auto">
        <source src="song/tum-tum-tamil-song-sri-vardhini-aditi-satya-yamini-ferni-roshini-tejaswini.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    
    <script>
        // DOM Elements
        const entranceSection = document.getElementById('entrance');
        const pathMapSection = document.getElementById('path-map');
        const tareefSection = document.getElementById('tareef-section');
        const spinWheelSection = document.getElementById('spin-wheel-section');
        const boxesSection = document.getElementById('interactive-boxes-section');
        const finalSection = document.getElementById('final-message');
        
        const darwazaKholBtn = document.getElementById('darwaza-khol');
        const nodes = document.querySelectorAll('.node');
        const spinButton = document.getElementById('spin-button');
        const wheel = document.getElementById('wheel');
        const spinResult = document.getElementById('spin-result');
        const boxes = document.querySelectorAll('.box');
        const musicToggle = document.getElementById('music-toggle');
        const backgroundMusic = document.getElementById('background-music');
        
        // Tareef Lines
        const tareefLines = [
            "meri gudiya ki muskan chand jesi lgti h mujhe hoshiyaari nhi chlegi lalaa.",
            "meri cucconiya ki aankho ki har ek khufiya kahani se mujhe maje aate h hihi",
            "meri Rakshita ki aankh marne ki techique hmare dimag ka jantar mantr jal mahal mahal bn jata h pighal kar.",
            "meri gudiya ka hansna barish ki boonden lagta hai, har gham dhona kar jaaye.",
            "meri cucconiya ki awaaz mein ek jaadu hai jo dil ko choo jata hai.",
            "meri Rakshita ke hone se har jagah roshni si lagti hai.",
            "meri gudiya ke kadam chal rahe ho to ful bhi muskan dete hain.",
            "meri cucconiya ki har baat mein ek khubsurti ki chamak hai.",
            "meri Rakshita ka chehra sitaron se bhi zyada chamakta hai.",
            "meri gudiya ke saath waqt beetana jaise ek pyaari kahani ka hissa ban jaana hai.",
            "meri cucconiya ki hasi se duniya ka har gham mit jaata hai.",
            "meri Rakshita ke aankhon mein pyaar ki gehraai hai, samundar bhi sharmaye.",
            "meri gudiya ka saath sirf ek pal nahi, zindagi bhar ka ehsaas hai.",
            "meri cucconiya ki baaton mein mithaas hai, jo dil ko mithaas de jaaye.",
            "meri Rakshita ki adayein aisi hain jaise phoolon pe sitare gir gaye ho.",
            "meri gudiya ka chehra dekh ke suraj bhi sharminda ho jaata hai.",
            "meri cucconiya ki har muskaan ek nayi duniya ke darwaze kholti hai.",
            "meri Rakshita ke saath har pal ek song sequence ki tarah lagta hai.",
            "meri gudiya ke aankhon ka sparkle, saari shaam ko roshan kar de.",
            " meri Rakshita ho to jaise zindagi ke har rang poore ho jaate hain."
        ];
        
        // Wheel sections
        const wheelSections = [
            "Bada Dhamaka",
            "Visfot Jordar",
            "Fuss",
            "Chmakta Huwa Tdkta Bhdkta",
            "Firse Ghumaye"
        ];
        
        // Initialize the page
        function init() {
            // Create floating diyas
            createFloatingDiyas();
            
            // Add event listeners
            darwazaKholBtn.addEventListener('click', openDoor);
            nodes.forEach(node => node.addEventListener('click', navigateToNode));
            spinButton.addEventListener('click', spinWheel);
            boxes.forEach(box => box.addEventListener('click', handleBoxClick));
            musicToggle.addEventListener('click', toggleMusic);
            
            // Create wheel sections
            createWheelSections();
            
            // Create tareef lines
            createTareefLines();
        }
        
        // Updated: Create floating emoji diyas
        function createFloatingDiyas() {
            const container = document.body; // Append to body to be behind content
            for (let i = 0; i < 15; i++) {
                const diya = document.createElement('div');
                diya.className = 'floating-diya';
                diya.innerHTML = 'ðŸª”'; // Set emoji
                diya.style.left = `${Math.random() * 100}%`;
                diya.style.top = `${Math.random() * 100}%`;
                diya.style.animationDelay = `${Math.random() * 5}s`;
                container.appendChild(diya);
            }
        }
        
        // Open door and show path map
        function openDoor() {
            entranceSection.style.display = 'none';
            pathMapSection.style.display = 'block';
            
            // Add footsteps animation
            animateFootsteps();
            
            // Show first node as active
            nodes[0].classList.add('active');
            
            // Auto-play music when door opens
            backgroundMusic.play().catch(e => {
                console.log("Auto-play prevented. User needs to interact first.");
            });
        }
        
        // Animate footsteps along the path
        function animateFootsteps() {
            const pathLine = document.querySelector('.path-line');
            const footsteps = document.createElement('div');
            footsteps.className = 'footsteps';
            pathLine.appendChild(footsteps);
            
            let position = 0;
            const interval = setInterval(() => {
                position += 2;
                footsteps.style.left = `${position}%`;
                footsteps.style.opacity = '1';
                
                if (position >= 100) {
                    clearInterval(interval);
                    footsteps.remove();
                }
            }, 30);
        }
        
        // Navigate to selected node
        function navigateToNode(e) {
            const nodeId = e.currentTarget.id;
            
            // Hide all sections
            tareefSection.style.display = 'none';
            spinWheelSection.style.display = 'none';
            boxesSection.style.display = 'none';
            finalSection.style.display = 'none';
            
            // Show selected section
            switch(nodeId) {
                case 'node1':
                    tareefSection.style.display = 'block';
                    showTareefLines();
                    break;
                case 'node2':
                    spinWheelSection.style.display = 'block';
                    break;
                case 'node3':
                    boxesSection.style.display = 'block';
                    break;
                case 'node4':
                    finalSection.style.display = 'block';
                    showFinalCelebration();
                    break;
            }
            
            // Update active node
            nodes.forEach(node => node.classList.remove('active'));
            e.currentTarget.classList.add('active');
        }
        
        // Create tareef lines
        function createTareefLines() {
            const tareefContainer = document.getElementById('tareef-lines');
            tareefLines.forEach(line => {
                const lineElement = document.createElement('p');
                lineElement.className = 'tareef-line';

                // Highlight the special names (case-insensitive) while preserving original text
                const replacements = [
                    {regex: /meri gudiya/ig},
                    {regex: /meri cucconiya/ig},
                    {regex: /meri rakshita/ig}
                ];

                let highlightedLine = line;
                replacements.forEach(r => {
                    highlightedLine = highlightedLine.replace(r.regex, match => `<span class="highlight">${match}</span>`);
                });

                lineElement.innerHTML = highlightedLine;
                tareefContainer.appendChild(lineElement);
            });
        }
        
        // Show tareef lines with animation
        function showTareefLines() {
            const lines = document.querySelectorAll('.tareef-line');
            let delay = 0;
            
            lines.forEach(line => {
                setTimeout(() => {
                    line.classList.add('visible');
                    
                    // Add confetti every few lines
                    if (Math.random() > 0.7) {
                        createConfetti(10); // Reduced confetti count here
                    }
                }, delay);
                
                delay += 2000; // 2 seconds between each line
            });
        }
        
        // Create wheel sections
        function createWheelSections() {
            const wheel = document.getElementById('wheel');
            const angle = 360 / wheelSections.length;
            
            wheelSections.forEach((section, index) => {
                const sectionElement = document.createElement('div');
                sectionElement.className = 'wheel-section';
                sectionElement.style.transform = `rotate(${index * angle}deg)`;
                sectionElement.innerHTML = `<div style="transform: rotate(${angle/2}deg); width: 100px; position: absolute; top: 10px;">${section}</div>`;
                wheel.appendChild(sectionElement);
            });
        }
        
        // Spin the wheel
        function spinWheel() {
            // Disable button during spin
            spinButton.disabled = true;
            spinResult.textContent = '';
            
            // Random rotation (multiple full rotations plus segment)
            const segments = wheelSections.length;
            const segmentAngle = 360 / segments;
            const extraRotations = 5; // Number of full rotations before stopping
            const randomSegment = Math.floor(Math.random() * segments);
            const rotation = extraRotations * 360 + (360 - randomSegment * segmentAngle);
            
            // Apply rotation
            wheel.style.transform = `rotate(${rotation}deg)`;
            
            // Determine result after animation
            setTimeout(() => {
                spinButton.disabled = false;
                
                const result = wheelSections[randomSegment];
                spinResult.textContent = result === "Visfot Jordar" 
                    ? "Congratulations! You won â‚¹200!" 
                    : `Better luck next time! You got: ${result}`;
                
                // Show celebration if winner
                if (result === "Visfot Jordar") {
                    createFireworks(20); // New fireworks
                    setTimeout(() => {
                        finalSection.style.display = 'block';
                        showFinalCelebration();
                    }, 2000);
                }
            }, 3000);
        }
        
        // Handle box click
        function handleBoxClick(e) {
            const text = e.currentTarget.getAttribute('data-text');
            
            // Create fireworks
            createFireworks(10); // New fireworks
            
            // Show glow effect
            e.currentTarget.style.background = 'linear-gradient(135deg, #ffd700 0%, #ffa500 100%)';
            e.currentTarget.style.boxShadow = '0 0 30px rgba(255, 215, 0, 0.9)';
            
            setTimeout(() => {
                e.currentTarget.style.background = 'linear-gradient(135deg, #ff8c00 0%, #ff4500 100%)';
                e.currentTarget.style.boxShadow = '0 0 15px rgba(255, 140, 0, 0.7)';
            }, 1000);
            
            // After third box click, show final message
            let allClicked = true;
            e.currentTarget.classList.add('clicked'); // Mark as clicked
            
            boxes.forEach(box => {
                if (!box.classList.contains('clicked')) {
                    allClicked = false;
                }
            });
            
            if (allClicked) {
                setTimeout(() => {
                    finalSection.style.display = 'block';
                    showFinalCelebration();
                }, 1000);
            }
        }
        
        // Show final celebration
        function showFinalCelebration() {
            createFireworks(30); // New fireworks
            createConfetti(50);
            
            // Update active node to final
            nodes.forEach(node => node.classList.remove('active'));
            nodes[3].classList.add('active');
        }
        
        // Updated: Create "Asli Jaise" Fireworks
        function createFireworks(count) {
            const container = document.body; // Append to body to overlay
            const colors = ['#ffd700', '#ff8c00', '#ff4500', '#ff00ff', '#00ffff', '#ffffff'];

            for (let i = 0; i < count; i++) {
                // Stagger the launches slightly
                setTimeout(() => {
                    const explosionX = Math.random() * window.innerWidth;
                    const explosionY = (Math.random() * window.innerHeight) / 2; // Upper half
                    const explosionColor = colors[Math.floor(Math.random() * colors.length)];
                    
                    // Create 30 particles per explosion
                    for (let j = 0; j < 30; j++) {
                        const particle = document.createElement('div');
                        particle.className = 'firework-particle';
                        
                        particle.style.left = `${explosionX}px`;
                        particle.style.top = `${explosionY}px`;
                        
                        const angle = Math.random() * Math.PI * 2;
                        const speed = Math.random() * 100 + 50; // Spread radius
                        
                        const tx = Math.cos(angle) * speed;
                        const ty = Math.sin(angle) * speed;
                        const ty_final = ty + 150; // Add "gravity"
                        
                        particle.style.setProperty('--tx', `${tx}px`);
                        particle.style.setProperty('--ty_final', `${ty_final}px`);
                        particle.style.setProperty('--color', explosionColor);
                        
                        container.appendChild(particle);
                        
                        // Remove after animation
                        setTimeout(() => {
                            particle.remove();
                        }, 1200); // Match animation duration
                    }
                }, Math.random() * 500); // Stagger explosions over 0.5s
            }
        }
        
        // Create confetti
        function createConfetti(count = 20) {
            const container = document.body; // Append to body to overlay
            
            for (let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                
                // Random position
                confetti.style.left = `${Math.random() * 100}%`;
                
                // Random color
                const colors = ['#ff0', '#f00', '#0f0', '#00f', '#f0f', '#ff8c00'];
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                // Random size
                const size = 5 + Math.random() * 10;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                
                // Random animation delay
                confetti.style.animationDelay = `${Math.random() * 2}s`;
                
                container.appendChild(confetti);
                
                // Remove after animation
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }
        
        // Toggle background music
        function toggleMusic() {
            if (backgroundMusic.paused) {
                backgroundMusic.play();
                musicToggle.textContent = 'ðŸ”Š'; // Changed emoji
                musicToggle.style.background = 'rgba(255, 215, 0, 0.9)';
            } else {
                backgroundMusic.pause();
                musicToggle.textContent = 'ðŸ”‡'; // Changed emoji
                musicToggle.style.background = 'rgba(255, 140, 0, 0.8)';
            }
        }
        
        // Initialize the application
        init();
    </script>
</body>
</html>